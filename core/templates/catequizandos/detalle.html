{% extends "base.html" %}

{% block title %}Perfil del Catequizando{% endblock %}

{% block content %}

<div class="mb-3">
    <a href="{% url 'catequizando_listar' %}" class="text-decoration-none text-muted fw-bold">
        <i class="bi bi-arrow-left me-1"></i> Volver al listado
    </a>
</div>

<div class="card profile-header-card mb-4 p-4">
    <div class="d-flex flex-column flex-md-row align-items-center gap-4">

        <div class="avatar-lg">
            {{ catequizando.primer_nombre|slice:":1" }}
        </div>

        <div class="flex-grow-1 text-center text-md-start">
            <h2 class="fw-bold mb-1">
                {{ catequizando.primer_nombre }} {{ catequizando.primer_apellido }}
            </h2>
            <p class="text-muted mb-2 font-monospace">
                <i class="bi bi-person-vcard me-1"></i> {{ catequizando.cedula }}
            </p>

            <span
                class="badge bg-success bg-opacity-10 text-success rounded-pill px-3 border border-success border-opacity-25">
                Registrado
            </span>
        </div>

        <div class="d-flex gap-2">
            <a href="{% url 'catequizando_editar' catequizando.pk %}" class="btn btn-warning shadow-sm">
                <i class="bi bi-pencil-square me-2"></i>Editar
            </a>
        </div>
    </div>
</div>

<div class="card card-section p-4 mb-5">
    <h5 class="fw-bold text-primary mb-3 pb-2 border-bottom">
        <i class="bi bi-person-lines-fill me-2"></i>Información Personal
    </h5>

    <div class="row g-4 mb-4">
        <div class="col-md-4">
            <div class="detail-label"><i class="bi bi-cake2 me-1"></i> Fecha de Nacimiento</div>
            <div class="detail-value">
                {{ catequizando.fecha_nacimiento|date:"d \d\e F \d\e Y" }}
            </div>
            <div class="detail-label mt-2"><i class="bi bi-geo-alt me-1"></i> Lugar de Nacimiento</div>
            <div class="detail-value">
                {{ catequizando.lugar_nacimiento|default:"No registrado" }}
            </div>
        </div>

        <div class="col-md-4">
            <div class="detail-label"><i class="bi bi-gender-ambiguous me-1"></i> Género</div>
            <div class="detail-value">
                {% if catequizando.genero == 'M' %}
                Masculino
                {% elif catequizando.genero == 'F' %}
                Femenino
                {% else %}
                {{ catequizando.genero }}
                {% endif %}
            </div>
            <div class="col-md-12">
                <div class="detail-label"><i class="bi bi-map me-1"></i> Dirección</div>
                <div class="detail-value">
                    {{ catequizando.direccion }}
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="detail-label"><i class="bi bi-telephone me-1"></i> Teléfono</div>
            <div class="detail-value">
                {{ catequizando.telefono_casa|default:"No registrado" }}
            </div>
        </div>

        
    </div>

    <h5 class="fw-bold text-danger mb-3 pb-2 border-bottom pt-2">
        <i class="bi bi-heart-pulse me-2"></i>Información Médica
    </h5>

    <div class="row g-4 mb-4">
        <div class="col-md-4">
            <div class="detail-label"><i class="bi bi-droplet-fill me-1"></i> Tipo de Sangre</div>
            <div class="detail-value text-danger fw-bold">
                {{ catequizando.informacion_salud.tipo_sangre|default:"--" }}
            </div>

            <div class="detail-label mt-3"><i class="bi bi-telephone-plus me-1"></i> Contacto de Emergencia</div>
            <div class="detail-value">
                {{ catequizando.informacion_salud.contacto_emergencia|default:"No registrado" }}
            </div>
        </div>

        <div class="col-md-8">
            <div class="detail-label"><i class="bi bi-exclamation-triangle me-1"></i> Alergias</div>
            <div class="detail-value">
                {% if catequizando.informacion_salud and catequizando.informacion_salud.alergias %}
                {% for a in catequizando.informacion_salud.alergias %}
                <span class="text-danger fw-bold bg-danger bg-opacity-10 px-2 py-1 rounded me-1">
                    {{ a }}
                </span>
                {% endfor %}
                {% else %}
                <span class="text-muted"><i class="bi bi-check2-circle"></i> Ninguna alergia registrada</span>
                {% endif %}
            </div>
        </div>
    </div>

    <h5 class="fw-bold text-warning mb-3 pb-2 border-bottom pt-2" style="color: #fd7e14 !important;">
        <i class="bi bi-book me-2"></i>Escolaridad
    </h5>

    <div class="row g-4 mb-4">
        <div class="col-md-4">
            <div class="detail-label"><i class="bi bi-calendar-event me-1"></i> Año en Curso</div>
            <div class="detail-value fs-5">
                {{ catequizando.escolaridad.anio_en_curso }}
            </div>

            <div class="detail-label mt-3"><i class="bi bi-building me-1"></i> Institución Educativa</div>
            <div class="detail-value">
                {{ catequizando.escolaridad.escuela_colegio|default:"No registrada" }}
            </div>
        </div>

        <div class="col-md-8">
            <div class="detail-label"><i class="bi bi-chat-square-text me-1"></i> Comentarios / Observaciones</div>
            <div class="p-3 bg-light rounded border-start border-4 border-warning text-muted">
                {{ catequizando.observaciones_generales|default:"Sin comentarios adicionales." }}
            </div>
        </div>
    </div>

    <h5 class="fw-bold text-info mb-3 pb-2 border-bottom pt-2">
        <i class="bi bi-droplet me-2"></i>Fe de Bautismo
    </h5>

    <div class="row g-4 mb-4">
        <div class="col-md-6">
            <div class="row">
                <div class="col-6 mb-3">
                    <div class="detail-label">Parroquia</div>
                    <div class="detail-value">{{ catequizando.fe_bautismo.parroquia|default:"--" }}</div>
                </div>
                <div class="col-6 mb-3">
                    <div class="detail-label">Ciudad</div>
                    <div class="detail-value">{{ catequizando.fe_bautismo.ciudad|default:"--" }}</div>
                </div>
                <div class="col-6 mb-3">
                    <div class="detail-label">Fecha</div>
                    <div class="detail-value">{{ catequizando.fe_bautismo.fecha|default:"--" }}</div>
                </div>
                <div class="col-6 mb-3">
                    <div class="detail-label">Sacerdote</div>
                    <div class="detail-value">{{ catequizando.fe_bautismo.sacerdote|default:"--" }}</div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="row">
                <div class="col-6 mb-3">
                    <div class="detail-label">Tomo</div>
                    <div class="detail-value">{{ catequizando.fe_bautismo.tomo|default:"--" }}</div>
                </div>
                <div class="col-6 mb-3">
                    <div class="detail-label">Página</div>
                    <div class="detail-value">{{ catequizando.fe_bautismo.pagina|default:"--" }}</div>
                </div>
                <div class="col-6 mb-3">
                    <div class="detail-label">Padrino</div>
                    <div class="detail-value">{{ catequizando.fe_bautismo.padrino|default:"--" }}</div>
                </div>
                <div class="col-6 mb-3">
                    <div class="detail-label">Madrina</div>
                    <div class="detail-value">{{ catequizando.fe_bautismo.madrina|default:"--" }}</div>
                </div>
            </div>
        </div>
    </div>

    <h5 class="fw-bold text-info mb-3 pb-2 border-bottom pt-2">
        <i class="bi bi-people me-2"></i>Familiares
    </h5>

    {% if catequizando.padres %}
    <div class="table-responsive">
        <table class="table table-sm table-borderless">
            <thead>
                <tr class="text-muted small text-uppercase">
                    <th>Relación</th>
                    <th>Nombre</th>
                    <th>Teléfono</th>
                </tr>
            </thead>
            <tbody>
                {% for p in catequizando.padres %}
                <tr>
                    <td class="fw-bold text-primary">{{ p.relacion }}</td>
                    <td>{{ p.nombres }} {{ p.apellidos }}</td>
                    <td>{{ p.telefono }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <p class="text-muted">No hay información de padres registrada.</p>
    {% endif %}

</div>

{% endblock %}